+++
date = "2016-03-29T19:45:25+09:00"
draft = true
title = "ファイル構成"
categories = ["ソース解説"]

+++

この文書では含まれているディレクトリやファイルがどういった意味合いなのかを解説します。

# ウェブサイトにアップロードする際に必要なファイルとディレクトリ

先にアップロードして閲覧するのに必要なファイルとディレクトリだけを書いておきます。
プロジェクトルートに対するディレクトリの構造は維持してください。

- `data/*`
- `css/*` *実はあんまり必須ではない*
- `dist/bundle.js`
- `calc.html`

# 設定ファイル

コードを書くのに使ったりする設定ファイルは以下のものです。

- `.gitignore` (バージョン管理でどのファイルを無視するか設定する)
- `package.json` (`npm`でどんなパッケージをインストールするか設定する)
- `webpack.config.js` (`webpack`に何をさせるかを設定する)

# 自動的に生成されるファイルとディレクトリ

このアプリ(プロジェクト)は全体を通して *webpack* と *npm* に強く依存しています。
その結果、いくつかのディレクトリとファイルが自動的に生成されて参照されます。

## node_modules

このディレクトリはnpmがモジュール(ライブラリ)をインストールする際に使用するディレクトリです。

webpackもこのディレクトリからモジュールを参照するので、
開発中は不必要にディレクトリを消すのは避けてください。

ただし、実際にウェブサイトとしてアップロードする際にはこのディレクトリは不要です。
ライブラリは後述するdistディレクトリに生成されるファイルに全て含まれます。

## dist

このディレクトリにwebpackは次のファイルを生成します。

- bundle.js
- test_bundle.js

`bundle.js`の方は`calc.html`で使われるJavascriptの本体です。
このファイルには使用しているライブラリが **全て** 含まれているので、
かなり大きいサイズになっているはずです。

`test_bundle.js`の方は`test.html`で使われるJavascriptファイルです。
このファイルも使用しているライブラリがいくつか含まれますが、
依存関係が(今のところ)小さいのでそこまで大きくないはずです。

# 外部データとかスタイルシート

次の場所にはbundle.jsなどのJavascriptから呼びだされて使用される
データやスタイルシートがあります。

- `data/job_data.json`
- `css/calc.css`

`data/job_data.json`については
`bundle.js`や`test_bundle.js`からFetch API経由で呼びだされるので、
絶対にプロジェクトルートからの位置は維持してください。

`css/calc.css`についてですが、
実のところこちらは`bundle.js`にビルド時に組みこまれており、
`test.html`もこれを必要としないので、アップロード時には無くてもあんまり問題はありません。

# JS/JSXファイル

これらに全て説明をつけるにはプログラム全体の説明をしなければなりませんので、
ここでは概要にとどめます。

## `entry.jsx`

エントリポイント(C/C++のmain関数相当)です。
ここでreduxのstoreを設定し、htmlと繋ぎあわせます。

## `atk_calc.js`

与えられたパラメータオブジェクトとジョブデータから
最終的な攻撃力を計算するための関数が入っています。
エラー処理はほとんどしていないのでそのあたりは呼びだし側に任されています。

## `get_job_data.js`

指定されたURLからJSONデータを読みこみPromiseオブジェクトとして返す関数が入っています。
デフォルトのURLはプロジェクトルート直下のdataディレクトリ内`job_data.json`です。
